<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Mysterious Quest</title>
  <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&family=Roboto:wght@300;700&display=swap" rel="stylesheet" />
  <style>
    /* Base Reset & Full-Screen Setup */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: black;
      font-family: 'IM Fell English SC', serif;
      color: #fff;
      overflow: hidden;
    }
    /* Container for Content Sections */
    #container {
      position: relative;
      z-index: 1;
      width: 100%;
      height: 100%;
      overflow-y: auto;
      box-sizing: border-box;
    }
    /* Each section takes the full viewport and centers its content */
    .section {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      text-align: center;
      padding: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 18px;
      background: #0F0;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin: 10px;
    }
    button:hover {
      background: #0C0;
    }
    /* Canvas for Falling Binary Code (Matrix Effect) */
    #matrix {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -3;
    }
    /* Treasure Map Overlay */
    .treasure-map {
      position: fixed;
      top: 10%;
      left: 5%;
      width: 300px;
      height: 300px;
      background: url('treasure-map.jpg') no-repeat center center;
      background-size: contain;
      opacity: 0.5;
      z-index: -2;
    }
    /* Responsive Adjustments */
    @media (max-width: 600px) {
      .treasure-map {
        width: 200px;
        height: 200px;
      }
      button {
        font-size: 16px;
      }
      .binary-text {
        font-size: 14px;
      }
    }
    .binary-text {
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 16px;
      max-width: 90%;
      background: rgba(0,0,0,0.7);
      padding: 15px;
      border: 1px solid #0F0;
      border-radius: 5px;
    }
    /* Style for the embedded video section */
    #videoSection iframe {
      width: 90%;
      max-width: 560px;
      height: 315px;
      border: none;
    }
  </style>
</head>
<body>
  <!-- Canvas for Falling Binary Code -->
  <canvas id="matrix"></canvas>
  
  <!-- Treasure Map Overlay -->
  <div class="treasure-map"></div>
  
  <!-- Main Content Container -->
  <div id="container">
    <!-- Section 1: Welcome Message -->
    <div id="section1" class="section">
      <h1>Welcome to the Treasure Hunt</h1>
    </div>
    
    <!-- Section 2: Start Button -->
    <div id="section2" class="section">
      <button id="startHuntBtn">Start the Hunt</button>
    </div>
    
    <!-- Section 3: Rules in Binary with Reveal Button -->
    <div id="section3" class="section" style="display:none;">
      <div id="rulesText" class="binary-text"></div>
      <button id="revealRulesBtn">Reveal Rules</button>
    </div>
    
    <!-- Section 4: Prizes in Binary with Reveal Button -->
    <div id="section4" class="section" style="display:none;">
      <div id="prizesText" class="binary-text"></div>
      <button id="revealPrizesBtn">Reveal Prizes</button>
    </div>
    
    <!-- Section 5: Event Info in Binary with Reveal Button -->
    <div id="section5" class="section" style="display:none;">
      <div id="eventInfoText" class="binary-text"></div>
      <button id="revealEventBtn">Reveal Event Info</button>
    </div>
    
    <!-- Section 6: Dare Prompt with Yes/No Buttons -->
    <div id="section6" class="section" style="display:none;">
      <p>So, do you dare to start the hunt?</p>
      <button id="yesBtn">Yes</button>
      <button id="noBtn">No</button>
    </div>
    
    <!-- Section 7: RSVP / Instagram Link -->
    <div id="section7" class="section" style="display:none;">
      <p>Then you can RSVP on our Instagram or just show up at the location.</p>
      <a href="https://www.instagram.com/nsbe_cbu" target="_blank" style="color: #0F0; font-size: 20px;">RSVP on Instagram</a>
    </div>
    
    <!-- Section 8: Embedded YouTube Video (for "No" response) -->
    <div id="section8" class="section" style="display:none;">
      <p>Maybe next time... Enjoy this video:</p>
      <div id="videoSection">
        <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      </div>
    </div>
  </div>
  
  <script>
    // ------------------------------
    // Falling Binary Code (Matrix Effect)
    // ------------------------------
    var canvas = document.getElementById("matrix");
    var ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    var binaryChars = "01".split("");
    var fontSize = 16;
    var columns = Math.floor(canvas.width / fontSize);
    var drops = [];
    for (var i = 0; i < columns; i++) {
      drops[i] = Math.floor(Math.random() * canvas.height / fontSize);
    }
    
    function drawMatrix() {
      ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "#0F0";
      ctx.font = fontSize + "px monospace";
      for (var i = 0; i < drops.length; i++) {
        var text = binaryChars[Math.floor(Math.random() * binaryChars.length)];
        ctx.fillText(text, i * fontSize, drops[i] * fontSize);
        if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
          drops[i] = 0;
        }
        drops[i]++;
      }
    }
    
    setInterval(drawMatrix, 50);
    
    window.addEventListener('resize', function(){
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      columns = Math.floor(canvas.width / fontSize);
      drops = [];
      for (var i = 0; i < columns; i++) {
        drops[i] = Math.floor(Math.random() * canvas.height / fontSize);
      }
    });
    
    // ------------------------------
    // Binary-to-Text Decoding Effect
    // ------------------------------
    // Utility: Convert text to binary representation
    function toBinary(text) {
      return text.split('').map(c => {
        if (c === "\n") return "\n";
        if (c === " ") return " ";
        return c.charCodeAt(0).toString(2).padStart(8, '0');
      }).join(' ');
    }
    
    // Function to gradually decode binary to clear text
    function decodeText(element, finalText, speed, callback) {
      let binaryArray = finalText.split('').map(c => {
        if (c === "\n") return "\n";
        if (c === " ") return " ";
        return c.charCodeAt(0).toString(2).padStart(8, '0');
      });
      let currentIndex = 0;
      let interval = setInterval(() => {
        if (currentIndex < finalText.length) {
          let display = "";
          for (let i = 0; i < finalText.length; i++) {
            if (i < currentIndex) {
              display += finalText[i];
            } else {
              if (finalText[i] === "\n") {
                display += "\n";
              } else if (finalText[i] === " ") {
                display += " ";
              } else {
                display += binaryArray[i];
              }
              if(i < finalText.length - 1 && finalText[i+1] !== "\n") {
                display += " ";
              }
            }
          }
          element.innerText = display;
          currentIndex++;
        } else {
          clearInterval(interval);
          element.innerText = finalText;
          if (callback) callback();
        }
      }, speed);
    }
    
    // ------------------------------
    // Define Final Text for Each Section
    // ------------------------------
    const rulesFinalText = "RULES:\n" +
      "1. Explore the clues hidden in binary puzzles.\n" +
      "2. Decipher the puzzles to reveal secrets.\n" +
      "3. Follow each clue to progress through the hunt.";
    
    const prizesFinalText = "PRIZES:\n" +
      "1st - $25 Visa Gift Card\n" +
      "2nd - $10 Visa Gift Card\n" +
      "3rd - Goodie Bag";
    
    const eventFinalText = "EVENT INFO:\n" +
      "Location: Engineering Building Room 119\n" +
      "Date & Time: Thursday, 27th February at 5:30\n" +
      "Food and snacks will be provided.";
    
    // Set initial binary text in the respective sections
    const rulesTextElement = document.getElementById("rulesText");
    rulesTextElement.innerText = toBinary(rulesFinalText);
    
    const prizesTextElement = document.getElementById("prizesText");
    prizesTextElement.innerText = toBinary(prizesFinalText);
    
    const eventInfoTextElement = document.getElementById("eventInfoText");
    eventInfoTextElement.innerText = toBinary(eventFinalText);
    
    // ------------------------------
    // Sequential Section Reveal Logic
    // ------------------------------
    
    // When "Start the Hunt" is clicked, hide welcome and start sections, show rules section
    document.getElementById("startHuntBtn").addEventListener("click", function() {
      document.getElementById("section1").style.display = "none";
      document.getElementById("section2").style.display = "none";
      document.getElementById("section3").style.display = "block";
    });
    
    // Reveal the Rules by decoding the binary text, then show the Prizes section
    document.getElementById("revealRulesBtn").addEventListener("click", function() {
      decodeText(rulesTextElement, rulesFinalText, 50, function() {
        setTimeout(function() {
          document.getElementById("section4").style.display = "block";
        }, 1000);
      });
      this.style.display = "none"; // Hide this button once clicked
    });
    
    // Reveal the Prizes by decoding the binary text, then show the Event Info section
    document.getElementById("revealPrizesBtn").addEventListener("click", function() {
      decodeText(prizesTextElement, prizesFinalText, 50, function() {
        setTimeout(function() {
          document.getElementById("section5").style.display = "block";
        }, 1000);
      });
      this.style.display = "none";
    });
    
    // Reveal the Event Info by decoding the binary text, then show the Dare Prompt section
    document.getElementById("revealEventBtn").addEventListener("click", function() {
      decodeText(eventInfoTextElement, eventFinalText, 50, function() {
        setTimeout(function() {
          document.getElementById("section6").style.display = "block";
        }, 1000);
      });
      this.style.display = "none";
    });
    
    // Dare prompt: If "No" is clicked, show the embedded video; if "Yes", show RSVP info
    document.getElementById("noBtn").addEventListener("click", function() {
      document.getElementById("section6").style.display = "none";
      document.getElementById("section7").style.display = "none";
      document.getElementById("section8").style.display = "block";
    });
    
    document.getElementById("yesBtn").addEventListener("click", function() {
      document.getElementById("section7").style.display = "block";
    });
  </script>
</body>
</html>
